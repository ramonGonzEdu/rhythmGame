{"version":3,"sources":["persistent.ts"],"sourcesContent":["import { addDrawer, ctx } from './autoCanvas.js';\nimport { map } from './helper.js';\n\nexport interface IPersistent {\n\tdraw(ctx: CanvasRenderingContext2D): void;\n\tlifetimeLeft(): number;\n}\n\nexport abstract class Persistent implements IPersistent {\n\tbirthTime = Date.now();\n\tlifeMapper: (n: number) => number;\n\n\tabstract draw(ctx: CanvasRenderingContext2D): void;\n\n\tconstructor(public deathTime: number) {\n\t\tthis.deathTime = deathTime;\n\t\tthis.birthTime = Date.now();\n\t\tthis.lifeMapper = map(this.birthTime, this.deathTime, 0, 1);\n\t}\n\n\tlifetimeLeft(): number {\n\t\treturn this.deathTime - Date.now();\n\t}\n}\n\nconst persistentItems: Persistent[] = [];\n\nexport function addPersistent(persistentItem: Persistent) {\n\tpersistentItems.push(persistentItem);\n}\n\nfunction drawPersistent() {\n\tfor (let i = persistentItems.length - 1; i >= 0; i--) {\n\t\tif (persistentItems[i].lifetimeLeft() > 0) {\n\t\t\tpersistentItems[i].draw(ctx);\n\t\t} else {\n\t\t\tpersistentItems.splice(i, 1);\n\t\t}\n\t}\n}\n\naddDrawer(drawPersistent);\n"],"names":["addDrawer","ctx","map","Persistent","constructor","deathTime","birthTime","Date","now","lifeMapper","lifetimeLeft","persistentItems","addPersistent","persistentItem","push","drawPersistent","i","length","draw","splice"],"mappings":"AAAA,SAASA,SAAS,EAAEC,GAAG,QAAQ,iBAAiB,CAAC;AACjD,SAASC,GAAG,QAAQ,aAAa,CAAC;AAOlC,OAAO,MAAeC,UAAU;IAM/BC,YAAmBC,SAAiB,CAAE;aAAnBA,SAAiB,GAAjBA,SAAiB;aALpCC,SAAS,GAAGC,IAAI,CAACC,GAAG,EAAE;QAMrB,IAAI,CAACH,SAAS,GAAGA,SAAS,CAAC;QAC3B,IAAI,CAACC,SAAS,GAAGC,IAAI,CAACC,GAAG,EAAE,CAAC;QAC5B,IAAI,CAACC,UAAU,GAAGP,GAAG,CAAC,IAAI,CAACI,SAAS,EAAE,IAAI,CAACD,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;KAC5D;IAEDK,YAAY,GAAW;QACtB,OAAO,IAAI,CAACL,SAAS,GAAGE,IAAI,CAACC,GAAG,EAAE,CAAC;KACnC;CACD;AAED,MAAMG,eAAe,GAAiB,EAAE,AAAC;AAEzC,OAAO,SAASC,aAAa,CAACC,cAA0B,EAAE;IACzDF,eAAe,CAACG,IAAI,CAACD,cAAc,CAAC,CAAC;CACrC;AAED,SAASE,cAAc,GAAG;IACzB,IAAK,IAAIC,CAAC,GAAGL,eAAe,CAACM,MAAM,GAAG,CAAC,EAAED,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,CAAE;QACrD,IAAIL,eAAe,CAACK,CAAC,CAAC,CAACN,YAAY,EAAE,GAAG,CAAC,EAAE;YAC1CC,eAAe,CAACK,CAAC,CAAC,CAACE,IAAI,CAACjB,GAAG,CAAC,CAAC;SAC7B,MAAM;YACNU,eAAe,CAACQ,MAAM,CAACH,CAAC,EAAE,CAAC,CAAC,CAAC;SAC7B;KACD;CACD;AAEDhB,SAAS,CAACe,cAAc,CAAC,CAAC"}